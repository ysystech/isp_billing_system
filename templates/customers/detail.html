{% extends "web/app/app_base.html" %}
{% load static %}
{% block app %}
<section class="app-card">
  <!-- Header with actions -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
    <div>
      <div class="breadcrumbs text-sm mb-2">
        <ul>
          <li><a href="{% url 'customers:customer_list' %}">Customers</a></li>
          <li>{{ customer.get_full_name }}</li>
        </ul>
      </div>
      <h1 class="pg-title">{{ customer.get_full_name }}</h1>
    </div>
    <div class="flex gap-2 mt-4 sm:mt-0">
      <a href="{% url 'customers:customer_update' customer.pk %}" class="btn btn-primary btn-sm">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
        </svg>
        Edit
      </a>
    </div>
  </div>

  <!-- Status Badge -->
  <div class="mb-6">
    {% if customer.status == 'active' %}
      <span class="badge badge-success badge-lg">Active Account</span>
    {% elif customer.status == 'inactive' %}
      <span class="badge badge-ghost badge-lg">Inactive Account</span>
    {% elif customer.status == 'suspended' %}
      <span class="badge badge-warning badge-lg">Suspended Account</span>
    {% else %}
      <span class="badge badge-error badge-lg">Terminated Account</span>
    {% endif %}
  </div>

  <!-- Customer Information Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Personal Information -->
    <div class="card bg-base-100 shadow-sm">
      <div class="card-body">
        <h2 class="card-title text-lg">Personal Information</h2>
        <div class="space-y-3">
          <div>
            <span class="text-sm text-gray-500">Full Name</span>
            <p class="font-medium">{{ customer.get_full_name }}</p>
          </div>
          <div>
            <span class="text-sm text-gray-500">Email</span>
            <p class="font-medium">{{ customer.email }}</p>
          </div>
          <div>
            <span class="text-sm text-gray-500">Primary Phone</span>
            <p class="font-medium">{{ customer.phone_primary }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Service Address -->
    <div class="card bg-base-100 shadow-sm">
      <div class="card-body">
        <h2 class="card-title text-lg">Service Address</h2>
        <div class="space-y-3">
          <div>
            <span class="text-sm text-gray-500">Complete Address</span>
            <p class="font-medium">{{ customer.get_complete_address }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Location Information -->
    <div class="card bg-base-100 shadow-sm">
      <div class="card-body">
        <h2 class="card-title text-lg">Location Information</h2>
        <div class="space-y-3">
          {% if customer.has_coordinates %}
          <div>
            <span class="text-sm text-gray-500">Coordinates</span>
            <p class="font-medium">{{ customer.coordinates_display }}</p>
          </div>
          <div>
            <span class="text-sm text-gray-500">Location Accuracy</span>
            <p class="font-medium">{{ customer.get_location_accuracy_display }}</p>
          </div>
          {% if customer.location_notes %}
          <div>
            <span class="text-sm text-gray-500">Location Notes</span>
            <p class="font-medium">{{ customer.location_notes }}</p>
          </div>
          {% endif %}
          <div class="mt-4">
            <a href="https://www.google.com/maps?q={{ customer.latitude }},{{ customer.longitude }}" 
               target="_blank" 
               class="btn btn-sm btn-outline">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              View on Google Maps
            </a>
          </div>
          {% else %}
          <p class="text-gray-500 italic">No location coordinates recorded</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Installation Details -->
    <!-- Account Information -->
    <div class="card bg-base-100 shadow-sm">
      <div class="card-body">
        <h2 class="card-title text-lg">Account Information</h2>
        <div class="space-y-3">
          <div>
            <span class="text-sm text-gray-500">Customer Since</span>
            <p class="font-medium">{{ customer.created_at|date:"F d, Y" }}</p>
          </div>
          <div>
            <span class="text-sm text-gray-500">Last Updated</span>
            <p class="font-medium">{{ customer.updated_at|date:"F d, Y g:i A" }}</p>
          </div>
          {% if customer.user %}
          <div>
            <span class="text-sm text-gray-500">Portal Access</span>
            <p class="font-medium text-success">Enabled</p>
          </div>
          {% else %}
          <div>
            <span class="text-sm text-gray-500">Portal Access</span>
            <p class="font-medium text-gray-500">Not configured</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Notes Section -->
  {% if customer.notes %}
  <div class="card bg-base-100 shadow-sm mt-6">
    <div class="card-body">
      <h2 class="card-title text-lg">Internal Notes</h2>
      <div class="prose max-w-none">
        {{ customer.notes|linebreaks }}
      </div>
    </div>
  </div>
  {% endif %}
</section>
{% endblock %}
